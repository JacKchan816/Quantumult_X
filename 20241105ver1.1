// ==UserScript==
// @ConfigName        墨鱼自用的QX配置文件
// @Author            @ddgksf2013
// @TgChannel         https://t.me/ddgksf2021
// @WechatID          墨鱼手记
// @Feedback          💡请通过邮件反馈问题[其它方式一概无视]：𝐝𝐝𝐠𝐤𝐬𝐟𝟐𝟎𝟏𝟑@𝟏𝟔𝟑.𝐜𝐨𝐦 💡
// @UpdateTime        2024/10/28 21:49UTC/GMT +8
// @Function          请参考对应的注释或Tag
// @Appreciate        https://shrtm.nu/hGk2
// @MainFunction      去开屏广告、应用净化、超级VIP、智能分流、自动优选、图标订阅、流媒体查询、Boxjs订阅、IOS更新屏蔽
// @ExpressThanks     @ddgksf2013,@Nick-workflow,@KOP-XIAO,@DivineEngine,@blackmatrix7,@Orz-3,@yjqiang,@O7Y0,@Peng-YM,@Neurogram-R,@id77,@NobyDa,@17mon
// @ConfigVersion     2.0 (V226)
// @ConfigURL         https://github.com/ddgksf2013/Profile/raw/master/QuantumultX.conf
// ==/UserScript==


# [+]2024-10-24 78、解决部分用户浏览淘宝时出现卡顿问题
# [-]2024-10-28 79、移除配置Header的部分描述，移除本地关于百度贴吧的分流[该分流会导致百度地图搜索出现问题]


# > 建议在「其他设置」里「GeoLite2」的「来源」填写使用下面链接「任选一个」，并开启「自动更新」
; https://raw.githubusercontent.com/Loyalsoldier/geoip/release/Country.mmdb
; https://github.com/Hackl0us/GeoIP2-CN/raw/release/Country.mmdb


# > QuantumultX图标库订阅，打开以下URL，手机端点击图片即可快捷添加「1.0.30+」
; https://github.com/ddgksf2013/Icon/blob/master/README.md


# > 利用描述文件屏蔽IOS更新提醒（兼容IOS13、14、15、16、17）
# > 去「设置-通用-日期与时间-自动设置」，将日期改为2023年12月14日之前再打开下面链接，安装成功后重启恢复时间设置
; https://static.itsnebula.net/apple/noota/17.mobileconfig


# > QuantumultX @ddgksf2013 设置推荐
; 「通知」栏中，建议仅开启[策略检测通知]和[脚本通知]开关，「VPN」栏中，建议关闭[兼容性增强]、[分流匹配优化]和[MPM]开关


# 🟢 墨鱼提醒以上全部内容[包括本行]可自行在配置中删除，对使用并无影响

[general]

# > 用于节点延迟测试
server_check_url= http://www.gstatic.com/generate_204
# > 服务器测试超时时间 (毫秒)
server_check_timeout = 3000
# > 用于设置图标显示
profile_img_url=https://github.githubassets.com/images/modules/site/integrators/google.png
# > 用于Check节点IP地址(以下geo_location_checker任选一个即可)
geo_location_checker=disabled
;geo_location_checker=http://ip-api.com/json/?lang=zh-CN, https://raw.githubusercontent.com/KOP-XIAO/QuantumultX/master/Scripts/IP_API.js
# > 功能强大的解析器，用于引用资源的转换
resource_parser_url=https://raw.githubusercontent.com/KOP-XIAO/QuantumultX/master/Scripts/resource-parser.js
# > 下列路径将不经过QuanX的处理
excluded_routes=239.255.255.250/32, 24.105.30.129/32, 185.60.112.157/32, 185.60.112.158/32, 182.162.132.1/32
# udp_whitelist=1-442, 444-65535
# > 第一个filter为4g模式开启规则分流，第二个filter为其他wifi下开启规则分流，第三个wifi1修改成你路由器翻墙的wifi名开启直连模式，第四个wifi2为你公司或者其他有路由器翻墙的WiFi名走直连）
# > 默认关闭根据wifi切换模式，如需开启，删除下方的"#"即可
#running_mode_trigger=filter, filter, wifi1:all_direct, wifi2: all_direct
# > dns_exclusion_list
dns_exclusion_list=*.10099.com.cn, *.cmpassport.com, *.jegotrip.com.cn, *.icitymobile.mobi, id6.me, *.pingan.com.cn



[task_local]

[rewrite_local]

[rewrite_remote]

# ======= 会员解锁 ======= #
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/Bilibili.conf, tag=哔哩哔哩广告净化@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/dev/raw/master/ForOwnUse.conf, tag=墨鱼专属VIP@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true


# ======= 广告净化 ======= #
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/StartUp.conf, tag=墨鱼去开屏2.0@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/Applet.conf, tag=微信小程序去广告@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/YoutubeAds.conf, tag=油管去广告@Maasea, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/Weibo.conf, tag=微博去广告@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/Ximalaya.conf, tag=喜马拉雅去广告[卸载重装]@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/Amap.conf, tag=高德地图净化[卸载重装]@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/NeteaseAds.conf, tag=网易云净化@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true


# ======= 网页优化 ======= #
https://github.com/ddgksf2013/Rewrite/raw/master/Html/Q-Search.conf, tag=Safari超级搜索@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/Html/General.conf, tag=Google重定向@DivineEngine, update-interval=86400, opt-parser=false, enabled=true


# ======= 功能增强 ======= #
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/XiaoHongShu.conf, tag=小红书净化+去水印@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://gist.githubusercontent.com/ddgksf2013/f43026707830c7818ee3ba624e383c8d/raw/baiduCloud.adblock.js, tag=百度网盘净化@ddgksf2013, update-interval=86400, opt-parser=true, enabled=true
https://raw.githubusercontent.com/ddgksf2013/Rewrite/master/Function/UnblockURLinWeChat.conf, tag=微信解锁被屏蔽的URL@zZPiglet, update-interval=86400, opt-parser=false, enabled=true
https://raw.githubusercontent.com/chavyleung/scripts/master/box/rewrite/boxjs.rewrite.quanx.conf, tag=BoxJS商店版@chavyleung, update-interval=86400, opt-parser=false, enabled=false


[server_local]

[server_remote]
https://api.yuyan.vin/api/v1/client/subscribe?token=9657f2cf96f1297b3773b7adc0eff089, tag=YY, update-interval=172800, opt-parser=true, enabled=true

[dns]

;prefer-doh3
;doh-server = https://223.5.5.5/dns-query, https://223.6.6.6/dns-query
# > QuantumultX开启IPV6方法，删去下面的「no-ipv6」，在「VPN」栏中，开启「兼容性增强」
no-system
server=223.5.5.5
server=119.29.29.29
server=114.114.114.114
server=/*.icloud.com/119.29.29.29
server=/*.icloud.com.cn/119.29.29.29
server=/*.tencent.com/119.29.29.29
server=/*.weixin.com/119.29.29.29



[policy]

static=苹果服务, direct, 香港节点, 台湾节点, 美国节点, 日本节点, 狮城节点, proxy, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple.png
static=全球加速, 自动选择, direct, 香港节点, 台湾节点, 日本节点, 狮城节点, 美国节点, proxy, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/Global.png
static=哔哩哔哩, direct, 香港节点, 台湾节点, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/bilibili.png
static=国际媒体, 台湾节点, direct, 香港节点, 日本节点, 美国节点, 狮城节点, proxy, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/Streaming.png
static=兜底分流, 自动选择, 全球加速, direct, 香港节点, 台湾节点, 日本节点, 狮城节点, 美国节点, proxy, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/Final.png

#默认设置15分钟测速一次，可自行修改check-interval=后面的数值（单位：秒），tolerance=后面的数值不建议修改
#将下面的url-latency-benchmark的内容替换成static，并删除[check-interval=900, tolerance=0, ]即可手动选择节点
url-latency-benchmark=自动选择, server-tag-regex=^(.(?!(网易|墨鱼)))*$, check-interval=900, tolerance=0, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Auto.png
url-latency-benchmark=香港节点, server-tag-regex=(?=.*(港|HK|(?i)Hong))^((?!(台|日|韩|新|美)).)*$, check-interval=900, tolerance=0, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/HK.png
url-latency-benchmark=台湾节点, server-tag-regex=(?=.*(台|TW|(?i)Taiwan))^((?!(港|日|韩|新|美)).)*$, check-interval=900, tolerance=0, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/TW.png
url-latency-benchmark=日本节点, server-tag-regex=(?=.*(日|JP|(?i)Japan))^((?!(港|台|韩|新|美)).)*$, check-interval=900, tolerance=0, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/JP.png
url-latency-benchmark=狮城节点, server-tag-regex=(?=.*(新|狮|獅|SG|(?i)Singapore))^((?!(港|台|日|韩|美)).)*$, check-interval=900, tolerance=0, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/SG.png
url-latency-benchmark=美国节点, server-tag-regex=(?=.*(美|US|(?i)States|American))^((?!(港|台|日|韩|新)).)*$, check-interval=900, tolerance=0, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/US.png



[filter_remote]
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Spark/Spark.list, tag=spark, force-policy=direct, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Notion/Notion.list, tag=notion, force-policy=全球加速, update-interval=172800, opt-parser=true, enabled=true
https://raw.githubusercontent.com/ddgksf2013/Filter/master/Unbreak.list, tag=规则修正, force-policy=direct, update-interval=172800, opt-parser=true, enabled=true
https://raw.githubusercontent.com/Cats-Team/AdRules/main/qx.conf, tag=广告终结者, force-policy=reject, update-interval=172800, opt-parser=true, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/WeChat/WeChat.list, tag=微信直连, force-policy=direct, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/OpenAI/OpenAI.list, tag=OpenAi, force-policy=美国节点, update-interval=172800, opt-parser=true, enabled=true
https://raw.githubusercontent.com/ddgksf2013/Filter/master/Streaming.list, tag=国际媒体, force-policy=国际媒体, update-interval=172800, opt-parser=true, enabled=true
https://raw.githubusercontent.com/ddgksf2013/Filter/master/StreamingSE.list, tag=哔哩哔哩, force-policy=哔哩哔哩, update-interval=172800, opt-parser=true, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Apple/Apple.list, tag=苹果服务, force-policy=苹果服务, update-interval=172800, opt-parser=true, enabled=true
https://raw.githubusercontent.com/ConnersHua/RuleGo/master/Surge/Ruleset/Proxy.list, tag=全球加速, force-policy=全球加速, update-interval=172800, opt-parser=true, enabled=true
https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/main/ruleset/ASN.China.list, tag=国内网站, force-policy=direct, update-interval=172800, opt-parser=true, enabled=true



[filter_local]

# > 一些比较容易忽视的分流
host, ad.12306.cn, direct
host, sdkapp.uve.weibo.com, direct

# > local
ip-cidr, 10.0.0.0/8, direct
ip-cidr, 127.0.0.0/8, direct
ip-cidr, 172.16.0.0/12, direct
ip-cidr, 192.168.0.0/16, direct
ip-cidr, 224.0.0.0/24, direct
ip-cidr, 182.254.116.0/24, direct
geoip, cn, direct
final, 兜底分流



[http_backend]

# > Boxjs设置，改为使用http backend方式，访问地址改为http://127.0.0.1:9999，更新配置后请长按风车-更新，然后重启代理
# > BoxJs相关教程参考「https://docs.boxjs.app」
https://raw.githubusercontent.com/chavyleung/scripts/master/chavy.box.js, host=boxjs.com, tag=BoxJS, path=^/, enabled=false



[mitm]
passphrase = F00BBA37
p12 = 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

skip_validating_cert = true
force_sni_domain_name = false

hostname = -*.apple.com, -consumer.fcbox.com, -*huami.com, -weather-data.apple.com, -*amemv.com, -*snssdk.com, -www.google.com

# 🟢 墨鱼提醒passphrase和p12代为证书&主机名部分, 更新配置前可把旧的配置中passphrase和p12代码拷贝下来, 导入新的配置文件把内容粘贴在对应位置就不用重装证书
